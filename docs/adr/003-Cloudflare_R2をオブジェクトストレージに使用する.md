# ADR-003: Cloudflare R2をオブジェクトストレージに使用する

## ステータス

- [x] 承認
- [ ] 保留
- [ ] 却下

## 論点

商品画像等のファイル保存にどのオブジェクトストレージを使用するか。

## 決定事項

Cloudflare R2（S3互換オブジェクトストレージ）を使用する。

## 決定理由

- **エグレス料金ゼロ**: データ転送（エグレス）料金が無料で、画像配信コストを大幅に削減できる
- **S3互換API**: 既存のS3ツールやライブラリがそのまま使用でき、移行も容易
- **Workers統合**: バインディング経由で効率的にアクセスでき、認証処理が簡略化される
- **グローバルCDN**: Cloudflareのグローバルネットワークを通じて画像が配信され、高速
- **コスト効率**: ストレージコストが低く、小規模ECサイトに最適

## 代替案

### AWS S3 + CloudFront

- 成熟したサービスだが、エグレス料金が高額になる可能性がある
- Cloudflare Workersとの統合に追加の認証設定が必要

### Google Cloud Storage

- 機能は充実しているが、R2と同様のコスト優位性がない
- Cloudflareエコシステムとの統合が弱い

### Cloudflare Images

- 画像最適化機能が優れているが、コストが高い
- シンプルなストレージニーズにはオーバースペック
