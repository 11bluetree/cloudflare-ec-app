# ADR-012: Auth.jsを認証に使用する

## ステータス

- [x] 承認
- [ ] 保留
- [ ] 却下

## 論点

ユーザー認証とセッション管理をどのように実装するか。

## 決定事項

Auth.js（旧NextAuth.js）のエッジランタイム対応版を使用する。

## 決定理由

- **エッジ対応**: Cloudflare Workers環境で動作するようエッジランタイム対応版が提供されている
- **マルチプロバイダー**: メールアドレス/パスワード認証とソーシャルログイン（Google）を統一的に扱える
- **セキュリティ**: JWT、セッション管理、CSRF保護等のセキュリティ機能がビルトイン
- **柔軟性**: カスタムプロバイダーやコールバックで認証フローをカスタマイズ可能
- **D1統合**: アダプターを使用してD1にユーザー情報を保存可能
- **実績**: 広く採用されており、ドキュメントやコミュニティサポートが充実

## 決替案

### Cloudflare Access

- Cloudflare製だが、エンタープライズ向けで本プロジェクトには過剰
- カスタマイズ性が低い

### 自作認証

- 完全な制御が可能だが、セキュリティリスクが高い
- パスワードハッシュ、トークン管理、CSRF保護等を自前で実装する必要がある

### Clerk

- 高機能なSaaSだが、コストが発生する
- Cloudflareエコシステムとの統合が弱い
